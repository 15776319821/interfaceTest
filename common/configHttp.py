import requests
import json
import time
from common.Log import logger

logger = logger
class RunMain():

    def send_post(self, url, data, headers):# 定义一个方法，传入需要的参数url和data
        # 参数必须按照url、data顺序传入
        result = requests.post(url=url, data=data, verify=False, headers=headers).json()# 因为这里要封装post方法，所以这里的url和data值不能写死
        res = json.dumps(result, ensure_ascii=False, sort_keys=True, indent=2)
        return res

    def send_get(self, url, data ,headers):
        result = requests.get(url=url, data=data ,headers=headers)
        res = json.dumps(result, ensure_ascii=False, sort_keys=True, indent=2)
        return res

    def run_main(self, method, url=None, data=None):#定义一个run_main函数，通过传过来的method来进行不同的get或post请求
        result = None
        # headers = {
        #     "accept": "application/json,text/plain,*/*",
        #     "accept-encoding": "gzip,deflate,br",
        #     "accept-language": "zh-CN,zh;q=0.9",
        #     "content-length": "270",
        #     "content-type": "application/json;charset=UTF-8",
        #     "sec-fetch-dest": "empty",
        #     "sec-fetch-mode": "cors",
        #     "sec-fetch-site": "same-site",
        #     "token": "62fc466d-ae57-4d3b-85fa-bfac131cabee",
        #     "user-agent": "Mozilla/5.0 (Macintosh;IntelMacOSX10_14_6)AppleWebKit/537.36(KHTML,likeGecko)Chrome/87.0.4280.67 Safari/537.36"
        # }
        headers = {
            'Content-Type': 'application/json;charset=UTF-8',
            'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Safari/537.36',
            'token': 'ae9f392e-669c-4c30-ad82-d46e9a7e8553'
            # 'token':'694e4a3c-705f-41ae-a3e3-c8fc24e388f6'
        }
        time.sleep(5)

        if method == 'post':
            result = self.send_post(url, data, headers)
            logger.info(str(result))
        elif method == 'get':
            result = self.send_get(url, data , headers)
            logger.info(str(result))
        else:
            print("method值错误！！！")
            logger.info("method值错误！！！")
        return result
if __name__ == '__main__':#通过写死参数，来验证我们写的请求是否正确
    # userIds=[112675792,110665260,110441407,110562520,110627554,110506410,110292539,109750506,110635304,109281219,110928614,110992987,110634698,110476000,110495115,109594690,107101285,107097089,107040249,106354239,107518049,107393884,108067134,109960461,109647406,110547062,110832295,110654621,110525720,110540854,108935153,109717006,109871852,110578437,109721999,111198788,109521988,107281434,111030961,110027601,110785187,107637689,110848767,110227028,110734588,110641355,110843693,109260813,110459331,110070776,110229466,111161206,111181179,110507459,110883508,111003738,111009748,110860311,110775313,107719876,109838226,109823823,109368138,109988086,109677631,109633202,108461222,108031469,110175145,108998119,108535028,109229663,108660749,108959500,108389247,109053771,110619100,110464355,108012576,106167626,107078068,106986287,106973539,106971831,107072338,105787668,109411340,106985445,107015947,106166880,106519802,106586046,106871363,106473328,106784287,106936298,106512933,106597481,106508106,106424930,108558999,108556182,108300437,107362434,107291645,106794888,107262458,107492363,107327306,107882879,107818722,107839728,107827257,107772726,107901312,107381798,106947567,106728846,109909315,109975236,109958415,109759368,109889858,109964245,109667994,109475411,109537449,109683949,109219910,108186160,110088549,107429317,108154201,107747831,107775675,107009241,109125609,111180058,110293965,108938630,109360797,105747852,108553089,108549641,109425358,110879958,110970635,108151262,106987546,109422541,108413995,107287410,110676469,108683556,109326804,108763118,109098076,108741437,109103997,108895781,108794600,108950821,110586139,109004953,108864204,108519831,108838584,110314017,109976775,108991547,108883608,110178456,110884494,110330899,110336032,110331478,110790349,110696812,110678006,110469067,108813993,106284152,106312443,106291734,106485554,106535656,107045110,106612525,106963963,107072409,106997111,106542149,106978734,106969709,107042456,106814001,106977474,107061106,106353405,106571288,106798865,106739030,106850374,106368796,106538810,106721664,106885719,106788763,106417537,107104857,107184640,106798234,106791481,106419272,106786513,106293466,106663102,106820080,106691424,106346418,106896365,107130274,107120851,106713740,106714778,106659580,107162459,106778782,107132704,106635640,107123030,107025163,107264198,106992427,107279766,107251216,107431132,106636175,107486406,108215595,108300579,107346487,108321758,106695542,108297582,108209242,107510046,108328601,108349097,107375074,108212419,108227396,108351268,108266546,107476921,108225801,107852326,107738399,107735677,107819251,107979891,107603376,107977451,106697024,107919275,107769190,107731264,107563910,107948111,107314396,107834502,107667333,107968830,107750263,107550205,107915354,109904466,110030008,109634430,108068577,108018889,107696299,109893377,108093837,109924726,109500059,109714407,110099189,109595375,108010862,109957766,108120062,109845385,108040562,109979490,108053929,109767602,110038203,109507533,108121447,109765149,110006267,110107603,107445972,110096056,109969872,109850197,109979181,108125088,109777214,109545840,107605379,109135857,110105059,109755109,109934247,109771788,109767251,110024840,110040787,108914664,108878386,109464335,109632853,109542956,111146580,109657983,109633240,109601300,109706910,109587255,108079346,110932238,108404403,108404603,108439203,110987494,108376899,109776545,108439880,108500493,107910286,108593992,110143864,107926986,107621402,108618411,109503386,108537787,108396487,108553518,105677749,108607624,108463750,108620452,108530735,108583924,108593322,108548076,110353184,108648913,108633519,109439712,108589895,108633581,108522824,109448177,109410818,109199310,109473077,110865936,109257218,111086565,108277651,110915871,108721394,109211437,108083392,109085082,109148232,109370905,109244758,109258519,110675660,108122636,109235344,109133540,108456140,111135727,109184681,109257772,109370056,109326638,109238639,109098346,109243241,109252643,109393706,108897300,109102113,110726709,110972852,109361676,109131614,111087720,109373270,109344671,109226786,108766311,108796608,110384815,108519741,108547843,108628933,110158624,110628070,110431608,109000508,110526889,108954812,110419578,109018619,108814273,108664866,108971461,108684938,108908534,110434250,108882126,110420131,108870813,108875716,108772890,108948951,109054014,108715114,108946712,108963549,108973085,108893492,108964287,108665387,108776155,108670150,108625636,108473453,111226714,110297799,110980433,110341914,111139454,110366065,110934018,110982674,111154301,110828958,111058879,110934544,111160068,110324172,110896086,110779125,110174439,110669873,110585982,110566330,110805214,110756054,110641471,110430079,110416342,110985910,106871564,108257403,110640787,107570513,110758160,110518081,107218443,108638661,108022514,108128791,108221923,107988374,111102751,110038313,109600796,107616333,105711709,109912339,107615843,107510624,108260036,108564247,106019705,108607035,106989446,110999084,110376083,111070628,110749838,110187758,108407651,111026097,110920809,110209370,110861223,110038728,110739086,110837136,110244298,110167501,110929636,111030635,110870850,110931717,110983303,110322230,111071477,110794902,111074475,110540041,110233469,110500636,110506307,110566095,109734567,108334446,109864099,106732737,109820054,106669837,106832985,106841518,107064699,106619920,106999363,107008951,106477819,106493490,106977894,104482418,106938763,106867143,106838859,106761160,106491872,106435082,107158011,106322501,106336967,107360175,108334026,107257748,107321513,107429978,108223954,107271838,107416254,107481172,107345890,108291819,107477772,107256025,107404560,108227454,107498440,107537926,107277767,107122485,107282008,108309495,107680440,107895484,107681650,109927773,109608074,109503207,110063142,108140408,110058533,110028286,110022673,110098919,109761500,109782281,109809076,108103397,108105678,110083384,109781290,109801128,109639182,109415017,111641317,108396732,109654271,108387068,108442465,108369550,110880427,111364664,109654371,109523424,110048336,109898926,110137545,110182015,109214415,110862650,109254645,111124342,109306770,110289558,110645558,109323853,109084177,110711940,109242844,108535823,111091255,110873579,109458532,109136976,110923301,111052994,111117009,110144377,109419568,109458507,108666366,110405827,110416433,108666544,108732689,108895589,110464396,108820766,108679104,110357389,108794393,108831592,110399727,108875649,108808803,110506095,108510804,110488438,108917097,109002972,108499443,109076719,109028329,110267211,110593324,111041056,108125555,110785134,107503468,109986844,111213911,108835795,108413841,109418040,111164826,108963527,107391877,108758274,108108181,106851158,105994721,107425269,107453221,107851091,108297529,110928811,109397600,110094241,109128082,109230122,110299069,110909068,110190834,110339652,111105570,110594902,108509943,106569622,108797712,107484214,110561764,108487138,108376019,107450976,110635893,110028024,108020563,109513678,110341396,109893160,110382764,107521867,106411377,107013416,106614564,106807239,106787887,106809012,106728542,106591335,107040615,106874873,106814788,106582945,106650548,106442853,107250993,107288872,107136432,106379081,106371593,107405770,107269148,107018026,107267460,107380045,106406606,106625507,107739738,107319695,108327998,107678749,108314094,107169822,107835378,107893051,107984513,107643533,108269297,110585633,108215059,107817968,107961395,107683687,107738901,107747022,107714699,106346265,107726716,109774806,109949998,109875741,109590541,109883532,109946083,109814378,109978578,109934054,108961064,109834515,110039403,107405372,108075906,109919102,109495211,109517355,108066943,109528530,110074991,109887101,109818181,109968734,109467488,109494436,110112772,108057659,110022620,107768909,109693746,108444250,110325860,108443388,108391711,107767355,109321805,109669815,108397952,109495460,111205133,108220741,111086260,111067161,108365940,108669477,111214339,110036310,109273536,109159915,110626640,108769154,111014422,109340537,109807929,110036138,110350037,110163573,109415067,110258748,109391317,110168518,111143459,109458637,110136343,111055950,111108709,109422052,110353232,110214505,110167603,110791505,109402085,108504402,109431444,110151900,108496995,109451924,109455170,111016196,111077120,111202462,110926272,110585006,109232822,108779480,108807145,108657641,109274392,110523624,109226226,109327446,109078583,110653466,110173030,110037997,110593798,110343927,108830852,110541009,108828789,110399127,109186839,110984740,109085711,108755890,108688035,108920446,108835978,109086054,109322989,108731953,108732503,109045599,110819066,110952204,109302996,110483976,108784519,110261337,109275190,110869837,110282923,108743040,108746924,109086415,109200351,109269247,110641509,109183554,110410393,110154767,110479795,109221147,110755474,109155342,109129998,108802996,108680114,108705298,110589512,109178476,109107050,110882833,108739991,108810111,108983354,109051419,108946996,108957597,108968953,108372064,109042888,109044970,106334613,110121140,110662813,110864585,110941558,110692921,110695468,110887513,110208880,110972553,110359622,110042392,107782247,110670536,110689331,110825352,111060070,110159229,110943131,110669162,111166625,110629754,110785740,110162627,110792489,110723539,110339197,110323387,110908662,110610942,110409462,110550017,110580416,110594362,110479830,110539892,111011653,109310922,110158309,110239348,110479756,109800230,110952087,110061043,110168805,110343741,110408555,110095661,111151961,110507247,109743508,110961375,110126227,110135309,109832026,111210318,110103728,110996863,109230572,111168709,109811917,111079834,110342918,110296442,110268242,111112298,110347598,110129970,110961904,111163750,109848711,110913996,110176405,110197633,110910535,110998171,110153522,111113131,111088929,111125645,111026715,111022432,110913234,110389145,111083048,110790596,108277727,110912182,110358170,111202246,111167656,110223908,110161563,110968241,111131112,110148591,110909801,111107557,110273825,110309703,111137163,111011000,111063095,111117398,110309424,110168219,111197497,111038428,110174360,111028121,111075060,110219527,110166263,110501283,110623534,110830716,110506905,110666388,110752588,110513700,110447398,110545353,110696199,109312933,110744413,110467005,110146193,110515502,110578829,110803760,110860781,110394347,110063415,110312146,110484694,109904723,110900290,110889006,105408574,108048833,109579408,106781265,106738748,109020762,110065358,108327190,108671277,106965048,107843859,108357532,109680995,106739806,109225307,108153580,108080766,110021319,112002446,107993482,109102444,106364193,107005369,110520598,107223098,110685641,110030076,109967189,107127733,106394388,106726999,107056126,109486974,107913565,109528313,108459881,106896704,109182870,106480568,109197019,108723285,108699189,109409697,108968463,109632787,109106290,108024014,111164585,110226302,110164637,108749251,107768197,108540467,109151447,110632767,109160178,110170845,108535982,108569938,108902079,110647642,110880223,110026895,106805084,108432778,108519206,108550735,109030214,107843663,109206297,106534316,110000369,110313190,109508831,106998578,106739444,106676159,106612511,109817409,106370048,110801375,107519770,110263522,111083989,107908241,111192315,109915459,109969387,107410103,108823096,106693999,109783090,110272210,109752148,107689382,105010606,108430600,107918773,106796734,111115159,109916796,106825662,109118182,107710705,106699222,106810360,108298071,108364461,108523642,109439485,110292254,106764142,107739029,107713839,108777452,108707059,109647717,110226364,108310507,106454772,106971720,108833773,107810541,110717919,109859681,110846137,109110796,108994419,106943248,106803134,109936818,110088450,108478204,107423922,109591860,109505027,109569315,110643355,109358460,111253357,110659558,110332064,107540029,108034038,108456336,108663872,109595019,107994184,106192446,107092578,106682764,107442789,108386274,109192827,108668918,108813010,108385390,108245161,107993944,108824951,108278936,108275754,109417158,108403351,109393219,108009839,109518027,106810127,109276064,111093423,109973497,107012591,108067549,107135123,106964624,106970592,106938660,107452518,107582491,109536494,108634969,108158452,109321758,109024955,107407606,106270834,107371235,108448967,109621828,106791164,108338022,110776620,107082298,110717651,107087220,110283922,108017179,109957171,108266402,109017017,108691951,108060317,111153693,106658676,110346942,105728031,108641001,108279923,109042516,107564895,109677065,110922591,109987487,105182414,106747279,107977132,106201265,109634498,106938449,106983026,106562510,106397336,107099179,107204850,107634335,106790958,110536487,109661658,109478051,109551619,107055988,108255043,109451868,107397370,109415576,109106592,109230131,108642598,106451440,107332945,110224096,108110075,109232939,109072752,108658426,107631334,110898756,107367155,108872882,108046764,109569806,108403968,108433423,107088579,110798736,108322021,106603990,109233796,110910564,109796573,107011316,109901998,109636578,109598191,110016158,106758239,108285454,107077340,110800054,109587773,106263388,109360874,106846408,106458685,106340987,110569170,106459380,109997017,108925227,107309118,106923761,108025985,109408164,108884600,108527120,108363996,110556201,108818891,108989734,109075740,111073007,106496065,106795178,107206683,110696829,109903283,107100168,109760602,108195377,108475378,108969143,110666488,110768199,108723830,111054411,108597334,108960759,108416912,110697092,107378637,107339102,108984684,106089955,109593023,106817263,106697752,106743821,107016540,108295323,107738959,107590820,107859310,107660314,109527815,109434572,110420596,108657746,110976246,110235908,110660347,110317606,107884086,107979281,108778166,111183578,109010817,110662982,110487994,109795185,110911250,110041957,107629152,110459918,110349132,110472017,108886028,106789663,107113158,110934262,109810570,107676912,109345353,109274531,108543844,108669664,108706689,106518235,106807155,106819843,106922105,106657462,107275771,107347235,107738438,107491364,109578104,108064756,109825661,110095594,109623192,110026866,108134099,108275798,108543508,108599946,109106951,108523895,109300741,108550713,109199506,108974256,109028425,108140420,108913852,108986216,109713879,106942482,106991200,106923191,107136097,110874288,111144682,110879939,104667553,107611929,109592162,110107137,110161951,108913331,109000174,108181702,110429368,107686046,108560776,109957030,110478504,110953055,105082069,110976167,108118971,109625094,108572735,106278109,107117891,106597919,107471050,107569224,107789579,109767884,109843560,109950682,109892525,109763436,108056871,109979147,110106658,109870217,108912537,108809787,110359981,108958202,110451260,109923034,110818938,110675991,110803515,111025686,111155794,106955822,106560920,107262240,109994709,109766805,109620340,110789646,110659905,106928857,109904121,108552816,109390287,110220826,110589453,109137505,110134446,110359971,109148015,110103759,111526644,108287589,107543384,109780268,108757199,109509161,109175598,107912100,111209842,109704180,110190835,106204742,107036423,110806616,107307560,110641115,110072407,107041981,106507014,106577311,107206596,105559709,106791201,106767421,107134914,106948109,108470296,107174409,107129336,107254733,108281568,107485368,107375689,107491245,107596086,109529115,109004746,109126330,109005672,109256420,108959790,108974006,109340425,110972818,106287172,110314986,109621782,110132012,106953976,107056934,106616693,106304807,106807354,106661606,106623276,106569614,106730539,106537409,106598848,106653942,106783580,106467691,106670133,107113214,107110141,107219392,106723080,107266290,107294692,107318054,108255956,108219654,107424019,107260069,107732845,107959746,108029086,107724016,107854150,107582574,110175395,108001958,107757860,108049006,107976606,109744171,109500379,109577451,109521030,109768202,107799482,109805862,109935246,109610592,109866879,109574878,109716126,109460756,109698714,110023612,109507837,107818954,108430189,111255429,108461258,109235004,107681933,108529464,108235232,108810389,109473779,108465047,110267503,108548146,108612029,109337223,108880651,110790281,109166185,109128180,111178224,110780584,108558526,108697523,108672713,110448695,108736185,108744920,108859678,110592511,107297966,109660134,108921628,108954976,108996265,110505238,110458623,108864770,109386574,110447331,107856826,106682752,105558530,107350273,106478316,107439178,110214531,110792538,107832248,107590524,108505126,108034342,108365064,108312460,108126694,110801433,110953781,107778093,111208013,110545297,110461515,104757032,106802159,106880178,110849224,106843744,107152283,106341325,106661713,108263595,107430454,107844529,107631535,107609404,109416626,109477520,109781720,109818550,108054088,108454147,108406457,108685853,106239662,108594609,110940934,110938777,109091815,111004271,108740328,109435428,109437794,109212232,110913378,111131405,110297952,108609154,110595192,108884473,108226393,108832526,109531559,109273457,106788195,108236550,108902732,107878287,110843730,110406331,107056954,106370708,106184978,109536850,109573296,109064459,108108940,110167952,109824777,109933410,109766946,110562868,110119310,109787489,106279279,109272033,110650309,106869362,106855463,107526501,107285510,107358886,107205172,107546742,106330396,107566136,107690393,107594512,109976355,109521947,109795672,109626208,109693610,109489919,110009224,110012304,109597998,109789458,109378013,110005170,111001584,110158554,109168294,110162837,109416597,108605677,109366976,111159824,109367813,109131870,109330658,110720675,108794086,108791433,110602890,108875254,108459023,108755975,107788830,108971574,109058813,108906092,110420429,108854541,110180906,108988716,110548295,110620270,110264578,108448299,110580983,110837093,110422226,110484379,106552127,109565047,109147254,110310400,111145663,110243594,110990000,110473787,111107108,106812794,111160349]
    data = {
        "roomId": 100455,
        "count": 1,
        "source": 0,
        "toUserIds": [1813],
        "giftId": 43015
    }
    urls = 'https://dev.api.koudailive.com/api/trade/gift/giveGiftsBaoxiang?&uid=2005&token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1aWQiOiJNakF3TlE9PSIsInh5eiI6IlFURXdOMFE0TWtJdE0wVkROaTAwTWpVeExUazFOVGt0TmtRNU9FSTVRVVExTjBOQyIsImV4cCI6MTkyNDQwMDA0OX0.--fH2wg9y64EOIfATAIxb1wAuQMPOS6wzMnfaejb4Pg'
    url = 'https://dev.api.koudailive.com/api/trade/gift/giveGiftsBaoxiang?'
    uid = '2005'
    token = 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1aWQiOiJNakF3TlE9PSIsInh5eiI6IlFURXdOMFE0TWtJdE0wVkROaTAwTWpVeExUazFOVGt0TmtRNU9FSTVRVVExTjBOQyIsImV4cCI6MTkyNDQwMDA0OX0.--fH2wg9y64EOIfATAIxb1wAuQMPOS6wzMnfaejb4Pg'

    for i in range(11):
        result = RunMain().run_main('post', urls, json.dumps(data))
        print(result)
    # result = RunMain().run_main('post', urls, json.dumps(data))
    # login_res = json.dumps(login_result.json(), ensure_ascii=False, sort_keys=True, indent=2)
    print(result)